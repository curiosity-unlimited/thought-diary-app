# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Frontend [0.1.0]
#### Added
- Project foundation setup with Vue 3 + TypeScript + Vite
- Core dependencies: vue-router@4, pinia, axios, vue-toastification@next (Vue 3 compatible)
- UI framework: Tailwind CSS 4.x, PostCSS, Autoprefixer, @headlessui/vue
- Form validation: vee-validate, yup
- Linting and formatting: ESLint 9 (flat config), Prettier, TypeScript ESLint plugins
- Tailwind CSS configuration (tailwind.config.js) with content paths for Vue files
- PostCSS configuration (postcss.config.js) for Tailwind and Autoprefixer
- Custom CSS for sentiment highlighting: .positive (green) and .negative (red) spans
- Environment configuration: .env and .env.example files
- Environment variables: VITE_API_BASE_URL=http://localhost:5000, VITE_APP_NAME, VITE_APP_VERSION
- ESLint flat config (eslint.config.js) with Vue 3 and TypeScript support
- Prettier configuration (.prettierrc.json) with consistent formatting rules
- Prettier ignore file (.prettierignore) for build outputs
- Package.json scripts: lint, format commands
- Vite configuration with path aliases (@/ for src/) and port 5173
- Dev server successfully running with hot reload
- TypeScript interfaces in src/types/index.ts matching backend API responses
- User, DiaryEntry, DiaryStats interfaces for data models
- AuthState interface for Pinia store state management
- Request/Response interfaces for all API endpoints (LoginRequest, RegisterRequest, DiaryCreateRequest, etc.)
- ApiError interface for consistent error handling
- TokenResponse and AuthResponse interfaces for authentication
- PaginationInfo and DiaryListResponse interfaces for paginated data
- Axios API service in src/services/api.ts with 30-second timeout
- Request interceptor to automatically add JWT Bearer token to protected endpoints
- Response interceptor handling 401 Unauthorized with automatic token refresh
- Token refresh queue mechanism to prevent multiple simultaneous refresh calls
- Token rotation logic updating localStorage with new access tokens on refresh
- Automatic logout and redirect on refresh token expiry
- Network error handling with structured ApiError responses
- Helper functions for token management (getAccessToken, getRefreshToken, setTokens, clearTokens)
- Auth API methods: register(), login(), logout(), refreshToken(), getCurrentUser()
- Diary API methods: getDiaries(), getDiary(), createDiary(), updateDiary(), deleteDiary(), getDiaryStats()
- Comprehensive TSDoc comments for all functions and interfaces
- TypeScript strict mode enabled with proper type safety throughout
- ESLint configuration updated with browser globals support
- Path aliases configured in tsconfig.app.json (@/ for src/)
- All code formatted with Prettier and passes ESLint validation
- Pinia store implementation for state management (Step 3 complete)
- Auth store (src/stores/auth.ts) managing user authentication state
- Auth state: user, accessToken, refreshToken, isAuthenticated computed property
- Auth actions: register(), login(), logout(), refreshAccessToken(), fetchProfile()
- Token persistence in localStorage with automatic restore on app initialization
- Clear tokens on logout with proper cleanup
- Register action (note: backend requires separate login after registration)
- Login action with automatic token storage
- Token refresh handling with proper token rotation
- Diaries store (src/stores/diaries.ts) managing diary entries and statistics
- Diary state: entries array, currentDiary, stats, pagination, loading flag
- Diary actions: fetchDiaries(), fetchDiary(), createDiary(), updateDiary(), deleteDiary(), fetchStats()
- Pagination support with configurable page and per_page parameters
- Loading states for all async operations
- Optimistic UI updates for create/update/delete operations
- Store clearing on logout (clearStore() method)
- UI store (src/stores/ui.ts) for global UI state management
- Global loading state with isLoading and loadingMessage
- setLoading() and clearLoading() actions for loading overlay control
- hasLoadingMessage computed property
- Pinia configured in src/main.ts with proper Vue app registration
- All stores use Vue 3 Composition API with `<script setup>` pattern
- Stores follow best practices with proper TypeScript typing
- Error handling allows components to handle API errors appropriately
- All store code passes ESLint validation and TypeScript strict mode checks
- Toast notification system with vue-toastification (Step 4 complete)
- Toast plugin configured in src/main.ts with top-right position and 3-second timeout
- Toast CSS imported with default styling
- Toast options configured (position, timeout, closeOnClick, pauseOnHover, draggable)
- useToast composable in src/composables/useToast.ts with wrapper functions
- showSuccess() function for green success toasts (3-second timeout)
- showError() function for red error toasts (5-second timeout)
- showInfo() function for blue info toasts (3-second timeout)
- showWarning() function for yellow warning toasts (4-second timeout)
- showErrorWithRetry() function with retry button and custom callback
- Toast integration with API service error interceptor for global error handling
- Network error toasts with retry button for connection failures
- Session expiry toast when JWT tokens expire or refresh fails
- Success toast on logout
- Form validation errors excluded from global toast (handled in components)
- Retry mechanism for failed network requests triggered from toast button
- TypeScript types for all toast functions with TSDoc comments
- Vue Router configuration with createWebHistory mode (Step 5 complete)
- Router file created in src/router/index.ts with all route definitions
- Lazy loading configured for all route components using dynamic imports
- Routes defined: Home (/), Login (/login), Register (/register), Dashboard (/dashboard), Diaries (/diaries), DiaryDetail (/diaries/:id), Profile (/profile), About (/about), NotFound (404 catch-all)
- Route meta fields configured: requiresAuth, guestOnly, title for all routes
- Authentication guard implemented in router.beforeEach navigation guard
- Unauthenticated users redirected to /login when accessing protected routes
- Intended route saved in query parameter for redirect after successful login
- Guest-only guard redirects authenticated users from /login and /register to /dashboard
- Page title updates automatically on navigation using route meta.title
- Document.title format: "{Page Title} - {App Name}"
- 404 Not Found route configured for undefined paths
- Scroll behavior set to scroll to top on navigation, restore position on back/forward
- Router registered in src/main.ts between Pinia and Toast plugins
- App.vue updated to use <RouterView /> component
- Placeholder view components created for all routes with Tailwind styling
- Home view with landing page design, CTA buttons, and navigation links
- Login view placeholder with link to register (full implementation in Step 7)
- Register view placeholder with link to login (full implementation in Step 7)
- Dashboard view placeholder with link to diaries (full implementation in Step 9)
- Diaries view placeholder with navigation (full implementation in Step 9)
- DiaryDetail view placeholder using route params (full implementation in Step 9)
- Profile view placeholder with navigation
- About view with app information, features list, and navigation
- NotFound view with 404 error page design and navigation to home
- TypeScript errors fixed: POSITION enum imported for toast configuration
- ESLint validation passed with no errors
- Prettier formatting applied to all view components and router configuration
- Layout components implementation (Step 6 complete)
- MainLayout component in src/layouts/MainLayout.vue with Navbar and router-view
- MainLayout uses responsive container with Tailwind classes
- MainLayout includes optional footer with copyright
- MainLayout uses <script setup> syntax with TypeScript
- AuthLayout component in src/layouts/AuthLayout.vue for login/register pages
- AuthLayout has centered card design with gradient background
- AuthLayout displays logo and app name at top
- AuthLayout uses <slot> for page content
- AuthLayout is responsive for mobile/tablet/desktop
- AuthLayout styled with Tailwind CSS
- Navbar component in src/components/Navbar.vue with full navigation
- Navbar displays logo/app name on left (book icon)
- Navbar has navigation links: Dashboard, Diaries, Profile, About
- Navbar shows user email from auth store in dropdown menu
- Navbar has logout button that calls auth store logout action
- Navbar implements mobile hamburger menu for small screens
- Navbar uses Headless UI Menu component for user dropdown
- Navbar highlights active route with different background color
- Navbar includes proper ARIA labels for accessibility
- Mobile menu toggles open/closed on hamburger button click
- Mobile menu displays navigation links and user info
- Desktop navigation uses horizontal layout with proper spacing
- All layouts follow mobile-first responsive design
- Layouts tested on different screen sizes
- All components pass ESLint validation with no errors
- All components formatted with Prettier
- Authentication views with VeeValidate and Yup validation (Step 7 complete)
- Validation schemas in src/utils/validationSchemas.ts with reusable email and password rules
- Email validation: RFC 5322 format, max 120 characters, required
- Password validation for registration: min 8 chars, uppercase, lowercase, digit, special character
- Login view (src/views/Login.vue) with AuthLayout wrapper
- Login form with email and password fields using VeeValidate
- Real-time validation on input with inline error messages below fields
- Submit button disabled during loading with animated spinner
- Auth store login() action called on submit
- Redirect to dashboard on success, or to intended route from query params
- Toast notification for API errors with proper error message
- Link to register page from login view
- Register view (src/views/Register.vue) with AuthLayout wrapper
- Register form with email and password fields using VeeValidate
- Password requirements displayed: 8+ chars, uppercase, lowercase, digit, special character
- Auth store register() action called on submit
- Success toast and redirect to login page after registration (backend requires separate login)
- Link to login page from register view
- TypeScript strict mode with proper error type checking (no any types)
- All authentication forms styled with Tailwind CSS
- Input focus states with indigo ring, error states with red border
- Button states: normal, hover, disabled, loading with proper styling
- Forms fully responsive on mobile, tablet, and desktop
- No ESLint errors or warnings
- No TypeScript compilation errors

#### Fixed
- Tailwind CSS 4.x PostCSS configuration: installed @tailwindcss/postcss and updated postcss.config.js


## [0.2.0] - 2026-01-13

### Backend [0.1.0]
#### Added
- Flask application infrastructure with application factory pattern
- Environment-based configuration system (Development, Testing, Production)
- Flask extensions initialization (SQLAlchemy, Flask-Migrate, Flask-Marshmallow, Flask-JWT-Extended, Flask-Limiter, Flask-CORS)
- Comprehensive error handlers with consistent JSON error format
- JWT authentication configuration with 15-minute access tokens and 7-day refresh tokens
- CORS configuration for frontend integration (http://localhost:5173)
- Rate limiting infrastructure with Redis support
- GitHub Models API configuration for AI sentiment analysis (gpt-4o)
- Environment variables documentation in .env.example
- Type hints (PEP 484) and comprehensive docstrings (PEP 257) throughout codebase
- Development dependencies: pytest, pytest-cov, pytest-flask
- Production dependencies: flask, flask-sqlalchemy, flask-migrate, flask-marshmallow, marshmallow-sqlalchemy, flask-jwt-extended, flask-limiter, bcrypt, flask-cors, requests, gunicorn, redis, python-dotenv
- User model with email validation, bcrypt password hashing, and verification methods
- ThoughtDiary model with content validation, sentiment analysis support, and user relationship
- Database models registered with SQLAlchemy for proper ORM functionality
- Flask-Migrate integration with initial migration for User and ThoughtDiary tables
- One-to-many relationship between User and ThoughtDiary with cascade delete
- Model helper methods: User.validate_email(), User.set_password(), User.check_password()
- Model helper methods: ThoughtDiary.validate_content(), ThoughtDiary.get_sentiment(), ThoughtDiary.to_dict()
- Database indexes on User.email, ThoughtDiary.user_id, and ThoughtDiary.created_at for query optimization- Password utility functions with strict validation requirements (8+ chars, uppercase, lowercase, number, special character)
- Bcrypt-based password hashing and verification functions
- Email format validation and input sanitization utilities
- Marshmallow schemas for authentication (RegisterSchema, LoginSchema, UserSchema, TokenSchema)
- Authentication blueprint with complete user auth endpoints
- POST /auth/register endpoint with rate limiting (3 requests/hour)
- POST /auth/login endpoint with JWT token generation and rate limiting (5 requests/15min)
- POST /auth/refresh endpoint for access token renewal
- POST /auth/logout endpoint with token blacklist support
- GET /auth/me endpoint for current user profile retrieval
- JWT token blacklist functionality for secure logout
- JWT callbacks for token validation and error handling (expired, invalid, missing, revoked tokens)
- Consistent error responses across all auth endpoints with error codes
- Integration between auth system and User model with secure password handling
- AI sentiment analysis service using GitHub Models API (gpt-4o)
- analyze_sentiment() function to identify positive and negative sentiment words
- HTML-based sentiment markers with <span class="positive"> and <span class="negative"> tags
- Automatic counting of positive and negative sentiment markers
- Comprehensive error handling for API timeouts, connection errors, and HTTP errors
- Graceful fallback to original content when sentiment analysis fails
- get_sentiment_summary() helper function for overall sentiment classification
- Environment variable configuration for GITHUB_TOKEN and GITHUB_MODEL_NAME
- Request timeout set to 30 seconds for AI API calls
- Detailed logging of sentiment analysis results and errors
- Thought Diary endpoints blueprint (app/blueprints/diaries/)
- Marshmallow schemas for diary operations (DiaryCreateSchema, DiaryUpdateSchema, DiarySchema, DiaryListSchema, DiaryStatsSchema)
- GET /diaries endpoint - List user's diaries with pagination (10 per page, descending by created_at)
- POST /diaries endpoint - Create new diary with automatic AI sentiment analysis
- GET /diaries/<id> endpoint - Get specific diary entry
- PUT /diaries/<id> endpoint - Update diary with automatic AI sentiment re-analysis
- DELETE /diaries/<id> endpoint - Delete diary entry
- GET /diaries/stats endpoint - Get user statistics (total, positive, negative, neutral entries)
- Authorization checks ensuring users can only access their own diaries (403 on unauthorized access)
- AI sentiment analysis integration on diary create and update operations
- Pagination support with configurable page size (default 10, max 100 items)
- JWT authentication required for all diary endpoints (@jwt_required decorator)
- Comprehensive error handling with consistent error format for all diary operations
- Comprehensive pytest test suite with 172 test cases covering all components
- Test configuration with fixtures in tests/conftest.py (app, client, db, test_user, auth_headers, test_diary)
- Unit tests for User and ThoughtDiary models (20 test cases)
- Unit tests for authentication endpoints (31 test cases covering register, login, refresh, logout, me, rate limiting)
- Unit tests for diary endpoints (24 test cases covering list, create, get, update, delete, stats, authorization)
- Unit tests for AI sentiment analysis service (18 test cases with mocked API calls)
- Unit tests for password utilities (22 test cases covering validation, hashing, verification)
- Unit tests for validators (26 test cases covering email validation, normalization, sanitization)
- Test coverage achieved: 94% (exceeds 80%+ requirement)
- External API mocking for isolated testing
- Edge case coverage including error handling, validation, and authorization
- Fixtures for database setup/teardown and JWT authentication
- Test organization mirroring source code structure
- Environment variable fixture for setting GITHUB_TOKEN in test environment

#### Fixed
- JWT identity type conversion: Added int() wrapper for get_jwt_identity() in all diary routes to match database integer user_id
- Marshmallow validator signatures: Updated validate_content() methods to accept **kwargs for compatibility with Marshmallow field validators
- AI service mocking: Configured test environment with GITHUB_TOKEN and correct patch paths for external API mocking
- Password hash length validation: Updated long password tests to respect bcrypt's 72-byte limit
- Email validation enhancement: Added checks to reject consecutive dots and leading/trailing dots in email addresses
- SQLAlchemy session handling: Fixed cascade delete test to use fresh database queries instead of cached instances
- Test code quality: Removed duplicate class definitions in test_ai_service.py (TestGetSentimentSummary, TestAPIIntegration)
- Import cleanup: Removed unused imports (pytest, timezone, time, json, MagicMock) across all test files
- Test assertions: Replaced pytest.skip() with early return and pytest.raises() with try/except pattern
- System endpoints: Created system blueprint with health check and version info endpoints (GET /health, GET /version)
- OpenAPI documentation: Integrated flasgger for Swagger UI available at GET /docs
- API documentation: Comprehensive OpenAPI/Swagger specs for all endpoints (auth, diaries, system)
- Health endpoint: Returns API health status and timestamp in ISO 8601 format
- Version endpoint: Returns API version (0.1.0) and API level (v1)
- Swagger configuration: Full OpenAPI 2.0 spec with security definitions (Bearer JWT)
- Endpoint documentation: Request/response schemas, error codes, authentication requirements documented
- API tags: Organized endpoints into System, Authentication, and Thought Diaries categories
- Security documentation: JWT Bearer token authentication flow documented
- Rate limiting documentation: Documented rate limits on register and login endpoints
- System blueprint tests: 9 comprehensive test cases covering health, version, and docs endpoints
- Test coverage: Achieved 95% overall test coverage (181 passing tests)
- Timezone-aware datetime: Updated health endpoint to use datetime.now(UTC) instead of deprecated utcnow()
- Development seed data script (app/utils/seed.py) for populating database with sample data
- Flask CLI command `flask seed` to run seeding operations
- Sample users: alice@example.com and bob@example.com with secure passwords (Dev only)
- Sample diary entries: 10 realistic diary entries per user with pre-analyzed sentiment
- Mixed sentiment entries: positive, negative, and neutral diary examples
- Idempotent seeding: Safe to run multiple times without creating duplicates
- Clear option: `flask seed --clear` to remove existing data before seeding
- Backdated entries: Diary entries created with timestamps 1-10 days ago for realistic data
- FLASK_APP environment variable added to .env.example for Flask CLI commands

#### Fixed (continued)
- Health endpoint: Fixed deprecation warning by using timezone-aware datetime (datetime.now(UTC))
- Docs endpoint test: Updated to handle redirect responses (301, 302, 308) in addition to 200

#### Documentation
- Comprehensive backend documentation suite in docs/ directory:
  - docs/backend-api.md: Complete REST API reference with authentication, endpoints, error handling, and examples
  - docs/backend-database.md: Database schema, models, migrations, query optimization, and backup strategies
  - docs/backend-development.md: Development setup, testing, debugging, and common tasks guide
  - docs/backend-architecture.md: System design, design patterns, security architecture, and data flow
  - docs/backend-deployment.md: Production deployment options (VPS, Docker, Heroku, Cloud), monitoring, and scaling
- Updated README.md with organized documentation links and descriptions
- Documentation follows "one purpose per document" principle with cross-references to avoid duplication
- All documentation includes practical examples, code snippets, and troubleshooting sections